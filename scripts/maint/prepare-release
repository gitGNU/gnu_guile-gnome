#!/bin/bash

package=$1
version=$2
prev=$3

if test -z "$package" -o -z "$version" -o -z "$prev"; then
    echo "usage: $0 PACKAGE VERSION PREV-VERSION" >&2
    exit 1
fi

dir=$(cd `dirname $0`/../.. && pwd)
echo "* prepare-release in $dir"
cd $dir

for i in *; do
    if test -d $i/.git; then
       packages="$packages $i";
    fi
done

# include pkg in the list
packages="$packages ."

for i in $packages; do
    ./scripts/maint/prepare-news-entry $i $package $version $prev
done
