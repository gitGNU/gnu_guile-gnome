#!/bin/sh

dir=$(cd `dirname $0`/.. && pwd)
cd $dir

for i in *; do
    if test -d $i/{arch}; then
       packages="$packages $i";
    fi
done

# include pkg in the list
packages="$packages ."

for i in $packages; do
  if (cd $i; tla changes -q > /dev/null; [ $? = 1 ]); then
    echo "* $i: tla commit $@"
    (cd $i && tla commit "$@")
  fi
done
